(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d7d60a34"],{"3da1":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-table",{staticClass:"table-content",attrs:{columns:t.columns,"row-key":function(t){return t.layoutId},"data-source":t.data,pagination:t.pagination,loading:t.loading,customRow:t.clickRow,rowClassName:t.addRowClass},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"layoutId",fn:function(e){return[a("span",[t._v(" "+t._s(e)+" ")]),a("a",{attrs:{href:"http://pc.jihui88.com/rest/site/"+e+"/index",target:"_blank"}},[t._v("[查看]")])]}},{key:"logo",fn:function(e,s){return[a("div",{staticClass:"table-content-span-ellipsis table-content-img-box flex"},[a("img",{staticClass:"table-content-img",attrs:{src:"http://cdn.jihui88.com/"+e,alt:""},on:{error:t.show404Imgs}})]),a("div",{staticClass:"table-content-span-edit"},[a("a",{on:{click:function(e){return t.changeImg(s,"logo")}}},[t._v("[上传]")])])]}},{key:"pic",fn:function(e,s){return[a("div",{staticClass:"table-content-span-ellipsis table-content-img-box flex"},[a("img",{staticClass:"table-content-img",attrs:{src:"http://cdn.jihui88.com/"+e,alt:""},on:{error:t.show404Imgs}})]),a("div",{staticClass:"table-content-span-edit"},[a("a",{on:{click:function(e){return t.changeImg(s,"pic")}}},[t._v("[上传]")])])]}},{key:"mobilePic",fn:function(e,s){return[a("div",{staticClass:"table-content-span-ellipsis table-content-img-box flex"},[a("img",{staticClass:"table-content-img",attrs:{src:"http://cdn.jihui88.com/"+e,alt:""},on:{error:t.show404Imgs}})]),a("div",{staticClass:"table-content-span-edit"},[a("a",{on:{click:function(e){return t.changeImg(s,"mobilePic")}}},[t._v("[上传]")])])]}},{key:"language",fn:function(e){return[a("span",{staticClass:"table-content-span-ellipsis"},[t._v(" "+t._s("1"==e?"中文":"英文")+" ")])]}},{key:"seoTitle",fn:function(e,s){return[s.editable?a("div",{key:t.editingKey,staticClass:"change-number-box"},[a("a-input",{attrs:{type:"text",placeholder:"请输入站点名称"},model:{value:t.inputId,callback:function(e){t.inputId=e},expression:"inputId"}}),a("div",{staticClass:"change-number-btn flex"},[a("a",{staticClass:"flex-1",attrs:{href:"javascript:;"},on:{click:function(e){return t.saveEdit(s.layoutId)}}},[t._v("保存")]),a("a",{staticClass:"flex-1",attrs:{href:"javascript:;"},on:{click:function(e){return t.cancelEdit(s.layoutId)}}},[t._v("取消")])])],1):t._e(),s.editable?t._e():a("span",{key:t.editingKey,attrs:{title:e}},[t._v(" "+t._s(e)+" "),a("a",{staticClass:"table-content-a",attrs:{href:"javascript:;",disabled:""!==t.editingKey},on:{click:function(e){return t.editList(s.layoutId)}}},[t._v("[编辑]")])])]}},{key:"state",fn:function(e,s){return[a("span",{attrs:{title:t.getState(e)}},[t._v(" "+t._s(t.getState(e))+" "),3==e?a("a",{staticClass:"table-content-a",attrs:{href:"javascript:;"},on:{click:function(e){return t.restoreSite(s.layoutId)}}},[t._v("[恢复]")]):t._e()])]}},{key:"endTime",fn:function(e){return[a("span",{staticClass:"table-content-span-ellipsis",attrs:{title:e?new Date(e).toLocaleString():"未知"}},[t._v(" "+t._s(e?new Date(e).toLocaleString():"未知")+" ")])]}},{key:"operation",fn:function(e,s){return[1==s.state?a("div",[[1!=s.copyState?a("a",{staticClass:"block",attrs:{href:"javascript:;"},on:{click:function(e){return t.templateOn(s)}}},[t._v("上架模板")]):a("a",{staticClass:"block",attrs:{href:"javascript:;"},on:{click:function(e){return t.templateOff(s)}}},[t._v("下架模板")])],[1!=s.isCase?a("a",{staticClass:"block",attrs:{href:"javascript:;"},on:{click:function(e){return t.caseOn(s)}}},[t._v("上架案例")]):a("a",{staticClass:"block",attrs:{href:"javascript:;"},on:{click:function(e){return t.caseOff(s)}}},[t._v("下架案例")])]],2):t._e(),a("div",[a("a",{staticClass:"block",attrs:{href:"javascript:;"},on:{click:function(e){return t.showModal("label",s)}}},[t._v("设置标签")]),a("a",{staticClass:"block",attrs:{href:"javascript:;"},on:{click:function(e){return t.showModal("endTime",s)}}},[t._v("审核（到期时间）")])]),a("div",[t.data.length?a("a-popconfirm",{attrs:{title:"确认复制吗?",okText:"确定",cancelText:"取消"},on:{confirm:function(){return t.copySite(s)}}},[a("a",{staticClass:"block",attrs:{href:"javascript:;"}},[t._v("同账号内复制网站")])]):t._e(),a("a",{staticClass:"block",attrs:{href:"javascript:;"},on:{click:function(e){return t.showModal("copy",s)}}},[t._v("复制网站到指定账号")])],1),a("div",[t.data.length?a("a-popconfirm",{attrs:{title:"确认关闭吗?",okText:"确定",cancelText:"取消"},on:{confirm:function(){return t.closeSite(s)}}},[a("a",{staticClass:"block",attrs:{href:"javascript:;"}},[t._v("关闭网站")])]):t._e(),t.data.length?a("a-popconfirm",{attrs:{title:"确认删除吗?",okText:"确定",cancelText:"取消"},on:{confirm:function(){return t.deleteSite(s)}}},[a("a",{staticClass:"block",attrs:{href:"javascript:;"}},[t._v("删除网站")])]):t._e()],1),a("div",[a("a",{staticClass:"block",attrs:{href:"javascript:;"},on:{click:function(e){return t.showModal("adminSet",s)}}},[t._v("管理员设置")])])]}}])}),a("a-modal",{attrs:{title:t.modalTitle,visible:t.modalVisible,wrapClassName:{"check-select-box":"label"==t.modalFlag}},on:{cancel:t.cancelModal}},["copy"==t.modalFlag?a("div",[[a("a-input",{attrs:{placeholder:"请输入帐号"},model:{value:t.siteUsername,callback:function(e){t.siteUsername=e},expression:"siteUsername"}})]],2):"endTime"==t.modalFlag?a("div",{staticStyle:{"text-align":"center"}},[[a("a-date-picker",{attrs:{showToday:!1,placeholder:"请选择到期时间"},model:{value:t.endTimeSelect,callback:function(e){t.endTimeSelect=e},expression:"endTimeSelect"}})]],2):"adminSet"==t.modalFlag?a("div",[a("a-spin",{attrs:{spinning:t.spinning,tip:"加载中。。。"}},[[a("a-input",{attrs:{placeholder:"请输入管理员"},model:{value:t.siteAdmin,callback:function(e){t.siteAdmin=e},expression:"siteAdmin"}})]],2)],1):a("div",[a("a-spin",{attrs:{spinning:t.spinning,tip:"加载中。。。"}},[[a("p",{staticClass:"check-select-box-p-error"},[t._v("注意：公司性质，功能，颜色，行业都需要选择一项， 否则模板那边将会搜索不到")]),t._l(t.checkboxAll,(function(e){return a("div",{key:e.categoryId},[a("p",{staticClass:"check-select-box-p-title"},[t._v(t._s(e.name)+"：")]),a("a-checkbox-group",{attrs:{name:"name",options:e.tagList,"default-value":t.checkedboxAll},on:{change:t.checkboxChange}}),"行业"==e.name?t._l(e.children,(function(e){return a("div",{key:e.categoryId},[a("p",{staticClass:"check-select-box-p-title"},[t._v(t._s(e.name)+"：")]),a("a-checkbox-group",{attrs:{name:"name",options:e.tagList,"default-value":t.checkedboxAll},on:{change:t.checkboxChange}})],1)})):t._e()],2)}))]],2)],1),a("template",{slot:"footer"},[a("a-button",{on:{click:t.cancelModal}},[t._v("取消")]),a("a-button",{attrs:{type:"primary"},on:{click:t.readySubmit}},[t._v("确定")])],1)],2),a("div",[a("a-modal",{staticClass:"img-upload-modal",attrs:{title:t.imgModalTitle},model:{value:t.imgModalVisible,callback:function(e){t.imgModalVisible=e},expression:"imgModalVisible"}},[a("a-upload",{attrs:{name:"Filedata",multiple:!1,action:t.imgUploadAction,headers:t.headers,data:t.uploadData,"before-upload":t.compressImg},on:{change:t.handleChange}},[a("div",{staticClass:"modal-box"},[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[t._v(" Upload ")])],1)]),a("template",{slot:"footer"},[a("a-button",{on:{click:t.cancelImgModal}},[t._v("取消")])],1)],2)],1)],1)},o=[],i=(a("4de4"),a("4160"),a("fb6a"),a("b0c0"),a("d3b7"),a("25f0"),a("159b"),a("2909")),n=a("5530"),c=[{title:"网站编号",dataIndex:"layoutId",width:"10%",scopedSlots:{customRender:"layoutId"}},{title:"公司logo",dataIndex:"logo",width:"10%",scopedSlots:{customRender:"logo"}},{title:"首屏图片",dataIndex:"pic",width:"10%",scopedSlots:{customRender:"pic"}},{title:"移动端首屏图片",dataIndex:"mobilePic",width:"10%",scopedSlots:{customRender:"mobilePic"}},{title:"语言版本",dataIndex:"language",width:"10%",scopedSlots:{customRender:"language"},ellipsis:!0},{title:"站点名称",dataIndex:"seoTitle",width:"10%",scopedSlots:{customRender:"seoTitle"}},{title:"审核状态",dataIndex:"state",width:"8%",scopedSlots:{customRender:"state"}},{title:"到期时间",dataIndex:"endTime",width:"8%",scopedSlots:{customRender:"endTime"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],l={name:"SiteVerifyTable",data:function(){return{console:!1,data:[],visible:!1,modalVisible:!1,spinning:!0,siteUsername:"",sort:void 0,modalTitle:"",selectedNo:"",modalFlag:"copy",editingKey:"",siteAdmin:"",imgModalVisible:!1,imgModalTitle:"",endTimeSelect:void 0,inputId:"",pagination:{page:1,current:1},loading:!1,imgSelectShow:!1,imgUploadAction:"",checkboxAll:[],checkedboxAll:[],columns:c,headers:{"X-CSRF-Token":sessionStorage.getItem("X-CSRF-Token")},uploadData:{layoutId:""}}},mounted:function(){this.fetch()},methods:{handleTableChange:function(t,e,a){var s=Object(n["a"])({},this.pagination);s.current=t.current,this.pagination=s,this.fetch(Object(n["a"])({results:t.pageSize,page:t.current,sortField:a.field,sortOrder:a.order},e))},fetch:function(){var t=this;this.loading=!0;var e={pageSize:10,page:this.pagination.current};if(sessionStorage.getItem("siteParams")){var a=JSON.parse(sessionStorage.getItem("siteParams"));a.startDate&&a.endDate||(delete a.startDate,delete a.endDate),e=Object(n["a"])(Object(n["a"])({},e),a)}this.$api.getAuditList(e).then((function(e){if(t.console&&console.log(e),0==e.data.code&&"success"==e.data.msg){t.loading=!1;var a=Object(n["a"])({},t.pagination);a.total=e.data.data.count,t.data=e.data.data.layoutList,t.pagination=a}else t.$message.error(e.data.msg)})).catch((function(t){console.log(t)}))},clickRow:function(t){var e=this;return{on:{click:function(){e.selectedNo=t.layoutId}}}},addRowClass:function(t){var e="";return t.layoutId===this.selectedNo&&(e="selected-tr"),e},cancelModal:function(){this.modalVisible=!1,this.siteUsername="",this.siteAdmin=""},cancelImgModal:function(){this.imgModalVisible=!1},readySubmit:function(){"copy"==this.modalFlag?this.submitCopySite():"label"==this.modalFlag?this.submitLabelSelect():"adminSet"==this.modalFlag?this.submitAdminSet():this.submitEndTime()},submitEndTime:function(){var t=this,e={layoutId:this.selectedNo,endTime:new Date(this.endTimeSelect.format("YYYY-MM-DD")+" 00:00:00").getTime()};this.$api.postEndTimeEdit(e).then((function(e){t.console&&console.log(e),0==e.data.code&&"success"==e.data.msg?(t.$message.success("修改成功"),t.cancelModal(),t.$emit("refresh",(new Date).getTime())):t.$message.error(e.data.msg)})).catch((function(t){console.log(t)}))},submitCopySite:function(){var t=this,e={layoutId:this.selectedNo,username:this.siteUsername};this.$api.postCopySiteToUser(e).then((function(e){t.console&&console.log(e),0==e.data.code&&"success"==e.data.msg?(t.$message.success("复制成功"),t.cancelModal()):t.$message.error(e.data.msg)})).catch((function(t){console.log(t)}))},submitAdminSet:function(){var t=this,e={layoutId:this.selectedNo,username:this.siteAdmin};this.$api.PostAdminSet(e).then((function(e){t.console&&console.log(e),0==e.data.code&&"success"==e.data.msg?(t.$message.success("修改成功"),t.cancelModal()):t.$message.error(e.data.msg)})).catch((function(t){console.log(t)}))},restoreSite:function(t){var e=this,a={layoutId:t};this.$api.postSiteRestore(a).then((function(t){e.console&&console.log(t),e.spinning=!1,0==t.data.code&&"success"==t.data.msg?(e.$message.success("还原成功"),e.$emit("refresh",(new Date).getTime())):e.$message.error(t.data.msg)})).catch((function(t){console.log(t)}))},showModal:function(t,e){"copy"==t?(this.modalTitle="输入用户帐号",this.modalFlag=t):"label"==t?(this.modalTitle="管理案例分类",this.modalFlag=t,this.getTagList(e.layoutId)):"adminSet"==t?(this.modalTitle="管理员设置",this.getAdminDetail(e.layoutId),this.modalFlag=t):(this.modalTitle="网站审核",this.modalFlag=t),this.modalVisible=!0},getTagList:function(t){var e=this;this.spinning=!0;var a={layoutId:t};this.$api.getCategoryTagList(a).then((function(t){if(e.console&&console.log(t),0==t.data.code&&"success"==t.data.msg){e.spinning=!1;for(var a=t.data.data.tagRelationShipsList,s=0;s<a.length;s++)e.checkedboxAll.push(a[s].tagId);e.checkboxAll=t.data.data.categoryList,e.parseJson(e.checkboxAll),console.log(e.checkboxAll)}else e.$message.error(t.data.msg)})).catch((function(t){console.log(t)}))},parseJson:function(t){var e="value",a="label";function s(t){return t.forEach((function(t){if(t.children&&Array.isArray(t.children)){t.tagList.forEach((function(t){t[a]=t.name,t[e]=t.tagId}));var o=t.children;s(o)}})),t}return t=t.slice(),s(t)},checkboxChange:function(){},submitLabelSelect:function(){for(var t=this,e=[],a=document.getElementsByName("name"),s=0;s<a.length;s++)a[s].checked&&e.push(a[s].value);e=e.toString();var o={layoutId:this.selectedNo,ids:e};this.$api.postSaveTags(o).then((function(e){t.console&&console.log(e),0==e.data.code&&"success"==e.data.msg?(t.$message.success("修改成功"),t.modalVisible=!1):t.$message.error(e.data.msg)})).catch((function(t){console.log(t)}))},getAdminDetail:function(t){var e=this;this.spinning=!0;var a={layoutId:t};this.$api.getAdminSet(a).then((function(t){e.console&&console.log(t),0==t.data.code&&"success"==t.data.msg?(e.spinning=!1,e.siteAdmin=t.data.data.username):e.$message.error(t.data.msg)})).catch((function(t){console.log(t)}))},caseOff:function(t){var e=this,a={layoutId:t.layoutId};this.$api.postSiteCaseOff(a).then((function(t){e.console&&console.log(t),0==t.data.code&&"success"==t.data.msg?(e.$message.success("修改成功"),e.$emit("refresh",(new Date).getTime())):e.$message.error(t.data.msg)})).catch((function(t){console.log(t)}))},caseOn:function(t){var e=this,a={layoutId:t.layoutId};this.$api.postSiteCaseOn(a).then((function(t){e.console&&console.log(t),0==t.data.code&&"success"==t.data.msg?(e.$message.success("修改成功"),e.$emit("refresh",(new Date).getTime())):e.$message.error(t.data.msg)})).catch((function(t){console.log(t)}))},templateOn:function(t){var e=this,a={layoutId:t.layoutId};this.$api.postSiteTemplateOn(a).then((function(t){e.console&&console.log(t),0==t.data.code&&"success"==t.data.msg?(e.$message.success("修改成功"),e.$emit("refresh",(new Date).getTime())):e.$message.error(t.data.msg)})).catch((function(t){console.log(t)}))},templateOff:function(t){var e=this,a={layoutId:t.layoutId};this.$api.postSiteTemplateOff(a).then((function(t){e.console&&console.log(t),0==t.data.code&&"success"==t.data.msg?(e.$message.success("修改成功"),e.$emit("refresh",(new Date).getTime())):e.$message.error(t.data.msg)})).catch((function(t){console.log(t)}))},deleteSite:function(t){var e=this,a={layoutId:t.layoutId};this.$api.postSiteDelete(a).then((function(t){e.console&&console.log(t),0==t.data.code&&"success"==t.data.msg?(e.$message.success("删除成功"),e.$emit("refresh",(new Date).getTime())):e.$message.error(t.data.msg)})).catch((function(t){console.log(t)}))},closeSite:function(t){var e=this,a={layoutId:t.layoutId};this.$api.postSiteClose(a).then((function(t){e.console&&console.log(t),0==t.data.code&&"success"==t.data.msg?(e.$message.success("关闭成功"),e.$emit("refresh",(new Date).getTime())):e.$message.error(t.data.msg)})).catch((function(t){console.log(t)}))},copySite:function(t){var e=this,a={layoutId:t.layoutId};this.$api.postCopySite(a).then((function(t){e.console&&console.log(t),0==t.data.code&&"success"==t.data.msg?(e.$message.success("复制成功"),e.$emit("refresh",(new Date).getTime())):e.$message.error(t.data.msg)})).catch((function(t){console.log(t)}))},changeImg:function(t,e){this.imgModalVisible=!0,this.uploadData.layoutId=t.layoutId,"logo"==e?(this.imgModalTitle="修改公司logo",this.imgUploadAction="".concat("/v4","/admin/pc/layout/logo/edit"),console.log(t)):"pic"==e?(console.log(t),this.imgModalTitle="修改首屏图片",this.imgUploadAction="".concat("/v4","/admin/pc/layout/pic/edit")):(console.log(t),this.imgModalTitle="修改移动端首屏图片",this.imgUploadAction="".concat("/v4","/admin/pc/layout/mobile/pic/edit"))},show404Imgs:function(t){t.target.src="http://cdn.jihui88.com/upload/j/j2/jhw_xlk/picture/2020/08/14/b4527c4b-f1f6-4e63-bef2-7daf7dd64b32.png"},editList:function(t){var e=Object(i["a"])(this.data),a=e.filter((function(e){return t===e.layoutId}))[0];console.log(e),this.editingKey=t,a&&(a.editable=!0,this.inputId=a.seoTitle||"")},cancelEdit:function(t){var e=Object(i["a"])(this.data),a=e.filter((function(e){return t===e.layoutId}))[0];a&&(delete a.editable,this.inputId=""),this.editingKey=""},saveEdit:function(t){var e=this,a=Object(i["a"])(this.data),s=a.filter((function(e){return t===e.layoutId}))[0];if(this.editingKey="",s){var o={layoutId:s.layoutId,name:this.inputId};this.console&&console.log(o),this.$api.postSiteNameEdit(o).then((function(t){e.console&&console.log(t),0==t.data.code&&"success"==t.data.msg?(e.$message.success("编辑成功"),s.seoTitle=e.inputId):e.$message.error(t.data.msg)})).catch((function(t){console.log(t)})),delete s.editable}},handleChange:function(t){console.log(t),"uploading"!==t.file.status&&console.log(t.file,t.fileList),"done"===t.file.status?0==t.file.response.code&&"success"==t.file.response.msg?(this.$message.success("图片上传成功"),this.$emit("refresh",(new Date).getTime())):this.$message.error(t.file.response.msg+"，请重新上传"):"error"===t.file.status&&this.$message.error("图片上传失败，请重新上传")},compressImg:function(t,e){if(console.log(t,e),t.size>2048e3)return this.$message.error("图片上传大小不得大于2M"),!1},getState:function(t){var e;switch(t){case"0":e="未审核";break;case"1":e="已审核";break;case"2":e="已过期";break;case"3":e="已删除";break;case"4":e="已关闭";break;default:e="其它"}return e}}},d=l,r=(a("7e58"),a("2877")),u=Object(r["a"])(d,s,o,!1,null,"4d0eea5a",null);e["default"]=u.exports},"7e58":function(t,e,a){"use strict";var s=a("d3bb"),o=a.n(s);o.a},d3bb:function(t,e,a){}}]);